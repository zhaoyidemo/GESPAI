import { NextResponse } from "next/server";
import prisma from "@/lib/db";

// GESP 5级完整题库 - 来源：洛谷 CCF GESP C++ 五级上机题
// 官方题单：https://www.luogu.com.cn/training/555
// 所有内容与洛谷100%一致

const gesp5Problems = [
  // ========== 样题 ==========
  {
    title: "[GESP样题 五级] 小杨的锻炼",
    source: "gesp_official",
    sourceId: "B3941",
    sourceUrl: "https://www.luogu.com.cn/problem/B3941",
    level: 5,
    knowledgePoints: ["最小公倍数", "最大公约数", "数论"],
    difficulty: "普及-",
    description: `小杨的班级里共有 $n$ 名同学，每位同学都有各自的锻炼习惯。具体来说，第 $i$ 位同学每隔 $a_i$ 天就会进行一次锻炼（也就是说，每次锻炼会在上一次锻炼的 $a_i$ 天后进行）。某一天，班上的 $n$ 名同学恰好都来进行了锻炼。他们对此兴奋不已，想要计算出下一次所有同学都来锻炼，至少要过多少天。`,
    inputFormat: `第一行一个整数 $n$，表示同学的数量。

第二行 $n$ 个用空格隔开的正整数，依次为 $a_0, a_1, \\ldots, a_{n-1}$。`,
    outputFormat: `输出一个整数，表示下一次所有同学都来锻炼，至少要过多少天。`,
    samples: [
      { input: "3\n1 2 3", output: "6" },
      { input: "4\n2 4 8 16", output: "16" },
      { input: "4\n2 4 6 8", output: "24" },
    ],
    testCases: [
      // 原始样例 (3个)
      { input: "3\n1 2 3", output: "6" },
      { input: "4\n2 4 8 16", output: "16" },
      { input: "4\n2 4 6 8", output: "24" },
      // 极端测试用例 (15个) - 覆盖边界和特殊情况
      { input: "2\n1 50", output: "50" },         // n=2最小, a极端混合
      { input: "2\n49 50", output: "2450" },      // 两个最大且互质
      { input: "10\n1 1 1 1 1 1 1 1 1 1", output: "1" },  // n=10最大, 全1
      { input: "10\n50 50 50 50 50 50 50 50 50 50", output: "50" },  // n=10最大, 全50
      { input: "2\n1 1", output: "1" },           // 全为1
      { input: "2\n50 50", output: "50" },        // 全为50
      { input: "10\n1 2 3 4 5 6 7 8 9 50", output: "12600" },  // 1到50混合
      { input: "3\n41 43 47", output: "82861" },  // 三个大质数
      { input: "4\n37 41 43 47", output: "3065857" },  // 四个大质数
      { input: "10\n2 3 5 7 11 13 17 19 23 29", output: "6469693230" },  // 10个小质数，最大LCM
      { input: "3\n6 10 15", output: "30" },      // 复杂公因子关系
      { input: "3\n12 18 24", output: "72" },     // 有公因子的三数
      { input: "3\n16 32 48", output: "96" },     // 2的幂次相关
      { input: "2\n25 50", output: "50" },        // 倍数关系
      { input: "2\n1 49", output: "49" },         // 1和49
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `**【样例解释 #1】**

第一位同学每天都要锻炼，第二位同学每隔两天会锻炼一次，第三位同学每隔三天会锻炼一次。在 $6$ 天后，三位同学都会来锻炼。可以证明，在第 $6$ 天前，不存在一天满足三位同学都会进行锻炼。

**【样例解释 #2】**

第四位同学每隔 $16$ 天锻炼一次，$16$ 天后他来锻炼，其他三位同学也恰好会来锻炼。

**【数据范围】**

对于 $20\\%$ 的数据，$n = 2$。

对于 $50\\%$ 的数据，$n = 4$。

对于 $100\\%$ 的数据，$2 \\le n \\le 10$，$1 \\le a_i \\le 50$。`,
  },
  {
    title: "[GESP样题 五级] 小杨的队列",
    source: "gesp_official",
    sourceId: "B3951",
    sourceUrl: "https://www.luogu.com.cn/problem/B3951",
    level: 5,
    knowledgePoints: ["逆序对", "排序", "冒泡排序"],
    difficulty: "普及-",
    description: `小杨是班级的体育委员。在一节体育课上，老师让小杨组织 $N$ 名同学（学号为 $0$ 至 $N - 1$）排成一列做体操。老师要求同学们按照身高从低到高排列。

老师会依次点名 $M$ 次，每次点名一名同学。该同学需要加入队伍。为保持身高顺序，同学们会通过两两交换位置的方式重新排列。每次交换只能交换相邻两位同学的位置。

小杨作为体育委员，需要在每一名同学加入队伍后，计算最少需要多少次交换才能使整个队伍恢复成身高从低到高的顺序。

需要注意的是，每次点名的同学会站到队伍的最后一位，然后队伍才会开始重新排序。`,
    inputFormat: `第一行包含一个整数 $N$，表示同学数量。

第二行包含 $N$ 个空格隔开的正整数，依次表示学号 $0$ 至 $N-1$ 的同学的身高。身高不超过 $2,147,483,647$。

第三行包含一个整数 $M$，表示点名次数。

接下来 $M$ 行，每行一个整数 $x$（$0 \\le x < N$），表示点名学号为 $x$ 的同学。`,
    outputFormat: `输出 $M$ 行，依次表示每次点名后，最少需要多少次交换才能使整个队伍保持身高从低到高的顺序。`,
    samples: [
      { input: "5\n170 165 168 160 175\n4\n0\n3\n2\n1", output: "0\n1\n1\n2" },
      { input: "4\n20 20 20 10\n4\n0\n1\n2\n3", output: "0\n0\n0\n1" },
    ],
    testCases: [
      // 原始样例 (2个)
      { input: "5\n170 165 168 160 175\n4\n0\n3\n2\n1", output: "0\n1\n1\n2" },
      { input: "4\n20 20 20 10\n4\n0\n1\n2\n3", output: "0\n0\n0\n1" },
      // 极端测试用例
      { input: "1\n100\n1\n0", output: "0" },  // 最小情况：1人1次点名
      { input: "2\n10 20\n2\n0\n1", output: "0\n0" },  // 2人，身高递增，无需交换
      { input: "2\n20 10\n2\n0\n1", output: "0\n1" },  // 2人，身高递减
      { input: "3\n100 100 100\n3\n0\n1\n2", output: "0\n0\n0" },  // 全相同身高
      { input: "5\n1 2 3 4 5\n5\n0\n1\n2\n3\n4", output: "0\n0\n0\n0\n0" },  // 严格递增
      { input: "5\n5 4 3 2 1\n5\n0\n1\n2\n3\n4", output: "0\n1\n2\n3\n4" },  // 严格递减，逆序对最大
      { input: "3\n2147483647 1 1000000000\n3\n0\n1\n2", output: "0\n1\n1" },  // 大数值身高
      { input: "4\n50 40 30 20\n4\n3\n2\n1\n0", output: "0\n1\n2\n3" },  // 从最矮开始点名
      { input: "4\n50 40 30 20\n4\n0\n1\n2\n3", output: "0\n1\n2\n3" },  // 从最高开始点名
      { input: "6\n10 30 20 40 50 60\n6\n0\n2\n1\n3\n4\n5", output: "0\n0\n1\n1\n1\n1" },  // 混合顺序
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `**【数据范围】**

对于所有测试点，$1 \\le M \\le N \\le 2000$。

对于 $50\\%$ 的测试点，所有同学身高互不相同。`,
  },
  // ========== 2023年9月 ==========
  {
    title: "[GESP202309 五级] 因数分解",
    source: "gesp_official",
    sourceId: "B3871",
    sourceUrl: "https://www.luogu.com.cn/problem/B3871",
    level: 5,
    knowledgePoints: ["质因数分解", "数论"],
    difficulty: "普及-",
    description: `每个正整数都可以表示成素数（质数）的乘积。例如，$6 = 2 \\times 3$，$20 = 2^2 \\times 5$。现在，给定一个正整数，请输出它的因数分解式。`,
    inputFormat: `输入第一行，包含一个正整数 $N$。约定 $2 \\le N \\le 10^{12}$。`,
    outputFormat: `输出一行，为 $N$ 的因数分解式。要求按素数由小到大排列；乘号用星号 \`*\` 表示，星号左右各空一格；当且仅当一个素数出现多次时，将它们合并为指数形式，指数用上箭头 \`^\` 表示，箭头左右不空格。`,
    samples: [
      { input: "6", output: "2 * 3" },
      { input: "20", output: "2^2 * 5" },
      { input: "23", output: "23" },
    ],
    testCases: [
      // 原始样例 (3个)
      { input: "6", output: "2 * 3" },
      { input: "20", output: "2^2 * 5" },
      { input: "23", output: "23" },
      // 极端测试用例
      { input: "2", output: "2" },  // 最小值，质数
      { input: "3", output: "3" },  // 最小奇质数
      { input: "4", output: "2^2" },  // 最小完全平方数
      { input: "8", output: "2^3" },  // 2的幂次
      { input: "1024", output: "2^10" },  // 2^10
      { input: "27", output: "3^3" },  // 3的幂次
      { input: "125", output: "5^3" },  // 5的幂次
      { input: "997", output: "997" },  // 较大质数
      { input: "999961", output: "999961" },  // 大质数
      { input: "30", output: "2 * 3 * 5" },  // 三个不同质因子
      { input: "210", output: "2 * 3 * 5 * 7" },  // 四个不同质因子
      { input: "360", output: "2^3 * 3^2 * 5" },  // 混合指数
      { input: "1000000000000", output: "2^12 * 5^12" },  // 10^12 = 2^12 * 5^12
      { input: "999999999989", output: "999999999989" },  // 接近10^12的大质数
      { input: "100", output: "2^2 * 5^2" },  // 完全平方数
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: ``,
  },
  {
    title: "[GESP202309 五级] 巧夺大奖",
    source: "gesp_official",
    sourceId: "B3872",
    sourceUrl: "https://www.luogu.com.cn/problem/B3872",
    level: 5,
    knowledgePoints: ["贪心", "调度问题", "排序"],
    difficulty: "普及/提高-",
    description: `小明参加一档名为"巧夺大奖"的综艺节目，游戏规则如下：

1. 整个游戏分为 $n$ 个时间段。每个时间段，小明可以选择一个小游戏参加（也可以不参加）。
2. 共有 $n$ 个小游戏可供选择。
3. 第 $i$ 个小游戏需要在第 $T_i$ 个时间段结束之前（包括第 $T_i$ 个时间段）完成，否则不能领取奖励。完成第 $i$ 个小游戏可获得奖励 $R_i$。

假设小明足够聪明，每个小游戏都在一个时间段内完成。请问小明最多可获得多少奖励？`,
    inputFormat: `第一行包含一个正整数 $n$，表示时间段数和小游戏数。$1 \\le n \\le 500$。

第二行包含 $n$ 个正整数 $T_i$，表示第 $i$ 个小游戏的完成期限。$1 \\le T_i \\le n$。

第三行包含 $n$ 个正整数 $R_i$，表示第 $i$ 个小游戏的奖励。$1 \\le R_i \\le 1000$。`,
    outputFormat: `输出一个正整数 $C$，表示小明最高可以获得的奖励。`,
    samples: [
      { input: "7\n4 2 4 3 1 4 6\n70 60 50 40 30 20 10", output: "230" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "7\n4 2 4 3 1 4 6\n70 60 50 40 30 20 10", output: "230" },
      // 极端测试用例
      { input: "1\n1\n100", output: "100" },  // 最小情况：1个游戏
      { input: "1\n1\n1000", output: "1000" },  // 最大奖励
      { input: "3\n1 1 1\n100 200 300", output: "300" },  // 所有截止时间相同，选最大
      { input: "3\n3 3 3\n100 200 300", output: "600" },  // 所有截止时间相同且充足
      { input: "5\n1 2 3 4 5\n10 20 30 40 50", output: "150" },  // 全部可完成
      { input: "5\n5 4 3 2 1\n10 20 30 40 50", output: "150" },  // 截止时间递减
      { input: "5\n1 1 1 1 1\n10 20 30 40 50", output: "50" },  // 只能完成1个
      { input: "4\n2 2 2 2\n100 200 300 400", output: "700" },  // 只能完成2个
      { input: "5\n1 2 3 4 5\n1000 1000 1000 1000 1000", output: "5000" },  // 相同奖励
      { input: "6\n1 2 1 2 3 3\n500 400 300 200 100 50", output: "1200" },  // 贪心选择
      { input: "10\n1 2 3 4 5 6 7 8 9 10\n100 90 80 70 60 50 40 30 20 10", output: "550" },  // 较大规模
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `**【样例解释】**

$7$ 个时间段分别完成第 $4$、$2$、$3$、$1$、$6$、$7$、$5$ 个小游戏。其中，第 $4$、$2$、$3$、$1$、$7$ 个小游戏在期限内完成，可以获得奖励。奖励总计 $40 + 60 + 50 + 70 + 10 = 230$。`,
  },
  // ========== 2023年12月 ==========
  {
    title: "[GESP202312 五级] 小杨的幸运数",
    source: "gesp_official",
    sourceId: "B3929",
    sourceUrl: "https://www.luogu.com.cn/problem/B3929",
    level: 5,
    knowledgePoints: ["完全平方数", "数论", "倍数"],
    difficulty: "普及/提高-",
    description: `小杨认为，所有大于等于 $a$ 的完全平方数都是他的超级幸运数。

小杨还认为，所有超级幸运数的倍数都是他的幸运数。自然地，小杨的所有超级幸运数也都是幸运数。

对于一个非幸运数，小杨规定，可以将它一直 $+1$，直到它变成一个幸运数。我们把这个过程叫做幸运化。例如，如果 $a=4$，那么 $4$ 是最小的幸运数，而 $1$ 不是，但我们可以连续对 $1$ 做 $3$ 次 $+1$ 操作，使其变为 $4$，所以我们可以说， $1$ 幸运化后的结果是 $4$。

现在，小杨给出 $N$ 个数，请你首先判断它们是不是幸运数；接着，对于非幸运数，请你将它们幸运化。`,
    inputFormat: `第一行 $2$ 个正整数 $a, N$。

接下来 $N$ 行，每行一个正整数 $x$ ，表示需要判断（幸运化）的数。`,
    outputFormat: `输出 $N$ 行，对于每个给定的 $x$ ，如果它是幸运数，请输出 \`lucky\`，否则请输出将其幸运化后的结果。`,
    samples: [
      { input: "2 4\n1\n4\n5\n9", output: "4\nlucky\n8\nlucky" },
      { input: "16 11\n1\n2\n4\n8\n16\n32\n64\n128\n256\n512\n1024", output: "16\n16\n16\n16\nlucky\nlucky\nlucky\nlucky\nlucky\nlucky\nlucky" },
    ],
    testCases: [
      // 原始样例 (2个)
      { input: "2 4\n1\n4\n5\n9", output: "4\nlucky\n8\nlucky" },
      { input: "16 11\n1\n2\n4\n8\n16\n32\n64\n128\n256\n512\n1024", output: "16\n16\n16\n16\nlucky\nlucky\nlucky\nlucky\nlucky\nlucky\nlucky" },
      // 极端测试用例
      { input: "1 3\n1\n2\n3", output: "lucky\nlucky\nlucky" },  // a=1，所有>=1的完全平方数都是超级幸运数
      { input: "4 5\n1\n2\n3\n4\n8", output: "4\n4\n4\nlucky\nlucky" },  // a=4
      { input: "100 5\n1\n99\n100\n200\n300", output: "100\n100\nlucky\nlucky\nlucky" },  // a=100
      { input: "9 6\n1\n8\n9\n18\n27\n36", output: "9\n9\nlucky\nlucky\nlucky\nlucky" },  // a=9
      { input: "4 4\n3\n5\n7\n11", output: "4\n8\n8\n12" },  // 都不是幸运数
      { input: "25 5\n24\n25\n50\n75\n100", output: "25\nlucky\nlucky\nlucky\nlucky" },  // a=25
      { input: "1000000 3\n1\n999999\n1000001", output: "1000000\n1000000\nlucky" },  // 大数边界
      { input: "4 3\n12\n16\n20", output: "lucky\nlucky\nlucky" },  // 都是4的倍数
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `**样例解释 1**

$1$ 虽然是完全平方数，但它小于 $a$，因此它并不是超级幸运数，也不是幸运数。将其进行 $3$ 次 $+1$ 操作后，最终得到幸运数 $4$。

$4$ 是幸运数，因此直接输出 \`lucky\`。

$5$ 不是幸运数，将其进行 $3$ 次 $+1$ 操作后，最终得到幸运数 $8$。

$9$ 是幸运数，因此直接输出 \`lucky\` 。

**数据规模**

对于 $30\\%$ 的测试点，保证 $a,x \\le 100,N \\le 100$。

对于 $60\\%$ 的测试点，保证 $a,x \\le 10^6$。

对于所有测试点，保证 $a \\le 1,000,000$；保证 $N \\le 2 \\times 10^5$；保证 $1 \\le x \\le 1,000,001$。`,
  },
  {
    title: "[GESP202312 五级] 烹饪问题",
    source: "gesp_official",
    sourceId: "B3930",
    sourceUrl: "https://www.luogu.com.cn/problem/B3930",
    level: 5,
    knowledgePoints: ["位运算", "按位与", "枚举"],
    difficulty: "普及/提高-",
    description: `有 $N$ 种食材，编号从 $1$ 至 $N$，其中第 $i$ 种食材的美味度为 $a_i$。

不同食材之间的组合可能产生奇妙的化学反应。具体来说，如果两种食材的美味度分别为 $x$ 和 $y$ ，那么它们的契合度为 $x\\ \\text{and}\\ y $。

其中，$\\text{and}$ 运算为按位与运算，需要先将两个运算数转换为二进制，然后在高位补足，再逐位进行与运算。例如，$12$ 与 $6$ 的二进制表示分别为 $1100$ 和 $0110$，将它们逐位进行与运算，得到 $0100$，转换为十进制得到 4，因此 $12\\ \\text{and}\\ 6 = 4$。**在 C++ 或 Python 中，可以直接使用 \`&\` 运算符表示与运算。**

现在，请你找到契合度最高的两种食材，并输出它们的契合度。`,
    inputFormat: `第一行一个整数 $N$，表示食材的种数。

接下来一行 $N$ 个用空格隔开的整数，依次为 $a_1,\\cdots,a_N$，表示各种食材的美味度。`,
    outputFormat: `输出一行一个整数，表示最高的契合度。`,
    samples: [
      { input: "3\n1 2 3", output: "2" },
      { input: "5\n5 6 2 10 13", output: "8" },
    ],
    testCases: [
      // 原始样例 (2个)
      { input: "3\n1 2 3", output: "2" },
      { input: "5\n5 6 2 10 13", output: "8" },
      // 极端测试用例
      { input: "2\n0 0", output: "0" },  // 最小值，全0
      { input: "2\n0 1", output: "0" },  // 0和任何数AND都是0
      { input: "2\n1 1", output: "1" },  // 相同数
      { input: "2\n7 7", output: "7" },  // 相同数
      { input: "3\n1 3 5", output: "1" },  // 奇数序列
      { input: "3\n2 4 6", output: "4" },  // 偶数序列 (4 & 6 = 4)
      { input: "4\n8 12 14 15", output: "14" },  // 14 & 15 = 14
      { input: "3\n255 127 63", output: "127" },  // 二进制全1的数
      { input: "4\n16 24 28 30", output: "28" },  // 28 & 30 = 28
      { input: "2\n2147483647 2147483647", output: "2147483647" },  // INT_MAX
      { input: "3\n2147483647 2147483646 2147483645", output: "2147483646" },  // 大数AND
      { input: "5\n1024 512 256 128 64", output: "0" },  // 2的幂次，互不相交
      { input: "4\n15 15 15 15", output: "15" },  // 全相同
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `**【样例解释 #1】**

编号为 $2,3$ 的食材之间的契合度为 $2\\ \\text{and}\\ 3=2$，是所有食材两两之间最高的契合度。

**【样例解释 #2】**

编号为 $4,5$ 的食材之间的契合度为 $10\\ \\text{and}\\ 13=8$，是所有食材两两之间最高的契合度。

**【数据范围】**

对于 $40\\%$ 的测试点，保证 $N \\le 1,000$。

对于所有测试点，保证 $N \\le 10^6$，$0 \\le a_i \\le 2,147,483,647$。`,
  },
  // ========== 2024年3月 ==========
  {
    title: "[GESP202403 五级] 成绩排序",
    source: "gesp_official",
    sourceId: "B3968",
    sourceUrl: "https://www.luogu.com.cn/problem/B3968",
    level: 5,
    knowledgePoints: ["排序", "多关键字排序", "模拟"],
    difficulty: "普及-",
    description: `有 $n$ 名同学，每名同学有语文、数学、英语三科成绩，你需要按照如下规则对所有同学的成绩从高到低排序：

1. 比较总分，高者靠前；
2. 如果总分相同，则比较语文和数学两科的总分，高者靠前；
3. 如果仍相同，则比较语文和数学两科的最高分，高者靠前；
4. 如果仍相同，则二人并列。

现在请你输出每位同学的排名。如果有 $x$ 人并列，那么这 $x$ 人的排名相同，并且需要把后面的 $x - 1$ 个名次空出来。`,
    inputFormat: `第一行一个整数 $N$，表示同学的人数。

接下来 $N$ 行，每行三个非负整数 $c_i, m_i, e_i$ 分别表示该名同学的语文、数学、英语成绩。`,
    outputFormat: `输出 $N$ 行，按输入同学的顺序，输出他们的排名。**注意：请不要按排名输出同学的序号，而是按同学的顺序输出他们各自的排名。**`,
    samples: [
      { input: "6\n140 140 150\n140 149 140\n148 141 140\n141 148 140\n145 145 139\n0 0 0", output: "1\n3\n4\n4\n2\n6" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "6\n140 140 150\n140 149 140\n148 141 140\n141 148 140\n145 145 139\n0 0 0", output: "1\n3\n4\n4\n2\n6" },
      // 极端测试用例
      { input: "2\n100 100 100\n50 50 50", output: "1\n2" },  // 最小情况，明确排名
      { input: "2\n100 100 100\n100 100 100", output: "1\n1" },  // 完全相同，并列第1
      { input: "3\n150 150 150\n100 100 100\n50 50 50", output: "1\n2\n3" },  // 总分不同
      { input: "3\n100 100 100\n150 50 100\n50 150 100", output: "3\n1\n1" },  // 总分相同，语数和相同，语数最高分决定
      { input: "4\n100 50 50\n50 100 50\n75 75 50\n60 60 80", output: "1\n1\n3\n4" },  // 复杂排名
      { input: "3\n150 0 0\n0 150 0\n75 75 0", output: "1\n1\n3" },  // 语数最高分相同
      { input: "2\n0 0 0\n0 0 0", output: "1\n1" },  // 全0分
      { input: "2\n150 150 150\n150 150 150", output: "1\n1" },  // 满分并列
      { input: "5\n100 90 80\n90 100 80\n80 90 100\n100 80 90\n90 80 100", output: "1\n1\n4\n3\n4" },  // 语数和不同，部分并列
      { input: "4\n100 100 50\n100 100 49\n99 100 51\n100 99 51", output: "1\n4\n2\n2" },  // 多级排序，3、4号并列第2
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `对 $30\\%$ 的数据，$N \\leq 100$，且所有同学总分各不相同。

对全部的测试数据，保证 $2 \\leq N \\leq 10^4$，$0 \\leq c_i, m_i, e_i \\leq 150$。`,
  },
  {
    title: "[GESP202403 五级] B-smooth 数",
    source: "gesp_official",
    sourceId: "B3969",
    sourceUrl: "https://www.luogu.com.cn/problem/B3969",
    level: 5,
    knowledgePoints: ["质因数分解", "筛法", "数论"],
    difficulty: "普及-",
    description: `小杨同学想寻找一种名为 $ B $-smooth 数的正整数。

如果一个正整数的最大质因子不超过 $ B $，则该正整数为 $ B $-smooth 数。

特别地，$1$ 没有质因子，我们认为 $1$ 是 $ B $-smooth 数。

小杨同学想知道，对于给定的 $ n $ 和 $ B $，有多少个不超过 $ n $ 的 $ B $-smooth 数。`,
    inputFormat: `第一行包含两个正整数 $ n $ 和 $ B $，含义如题面所示。`,
    outputFormat: `输出一个非负整数，表示不超过 $ n $ 的 $ B $-smooth 数的数量。`,
    samples: [
      { input: "10 3", output: "7" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "10 3", output: "7" },
      // 极端测试用例
      { input: "1 1", output: "1" },  // 最小情况，只有1
      { input: "1 2", output: "1" },  // n=1
      { input: "10 1", output: "1" },  // B=1，只有1满足
      { input: "10 2", output: "4" },  // 2-smooth: 1,2,4,8
      { input: "100 2", output: "7" },  // 2-smooth到100: 1,2,4,8,16,32,64
      { input: "100 5", output: "35" },  // 5-smooth到100
      { input: "1000 7", output: "149" },  // 7-smooth到1000
      { input: "100 100", output: "100" },  // B>=n，所有数都是B-smooth
      { input: "1000 1000", output: "1000" },  // B=n
      { input: "50 7", output: "24" },  // 中等规模
      { input: "1000000 2", output: "20" },  // 大n，小B
      { input: "1000000 1000000", output: "1000000" },  // 最大情况
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `### 样例解释

在不超过 $10$ 的正整数中，$3$-smooth 数有 $\\{1,2,3,4,6,8,9\\}$，共 $7$ 个。

### 数据规模与约定

| 子任务 | 得分 | $n \\leq $ | $B$ |
| :-: | :-: | :-: | :-: |
| $1$ | $30$ | $10^3$ | $1 \\leq B \\leq 10^3$ |
| $2$ | $30$ | $10^6$ | $\\sqrt n \\leq B \\leq 10^6$ |
| $3$ | $40$ | $10^6$ | $1 \\leq B \\leq 10^6$ |

对全部的测试数据，保证 $1 \\leq n, B \\leq 10^6$。`,
  },
  // ========== 2024年6月 ==========
  {
    title: "[GESP202406 五级] 黑白格",
    source: "gesp_official",
    sourceId: "P10719",
    sourceUrl: "https://www.luogu.com.cn/problem/P10719",
    level: 5,
    knowledgePoints: ["二维前缀和", "枚举", "子矩阵"],
    difficulty: "普及/提高-",
    description: `小杨有一个 $n$ 行 $m$ 列的网格图，其中每个格子要么是白色，要么是黑色。小杨想知道至少包含 $k$ 个黑色格子的最小子矩形包含了多少个格子。`,
    inputFormat: `第一行包含三个正整数 $n,m,k$，含义如题面所示。

之后 $n$ 行，每行一个长度为 $m$ 的 $\\texttt{01}$ 串，代表网格图第 $i$ 行格子的颜色，如果为 $\\texttt{0}$，则对应格子为白色，否则为黑色。`,
    outputFormat: `输出一个整数，代表至少包含 $k$ 个黑色格子的最小子矩形包含格子的数量，如果不存在则输出 $0$。`,
    samples: [
      { input: "4 5 5\n00000\n01111\n00011\n00011", output: "6" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "4 5 5\n00000\n01111\n00011\n00011", output: "6" },
      // 极端测试用例
      { input: "1 1 1\n1", output: "1" },  // 最小情况
      { input: "1 1 1\n0", output: "0" },  // 无黑格子
      { input: "1 5 3\n11111", output: "3" },  // 单行
      { input: "5 1 3\n1\n1\n1\n1\n1", output: "3" },  // 单列
      { input: "3 3 9\n111\n111\n111", output: "9" },  // 全黑
      { input: "3 3 10\n111\n111\n111", output: "0" },  // k超过总黑格数
      { input: "3 3 1\n000\n010\n000", output: "1" },  // 只有1个黑格
      { input: "2 2 2\n11\n00", output: "2" },  // 2x1矩形
      { input: "2 2 2\n10\n01", output: "4" },  // 对角黑格
      { input: "4 4 4\n1000\n0100\n0010\n0001", output: "16" },  // 对角线
      { input: "3 4 3\n0000\n1110\n0000", output: "3" },  // 中间一行
      { input: "5 5 1\n00000\n00000\n00100\n00000\n00000", output: "1" },  // 中心一点
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `**【样例解释】**

至少包含 $5$ 个黑色格子的最小子矩形的四个顶点为 $(2,4)$，$(2,5)$，$(4,4)$，$(4,5)$，共包含 $6$ 个格子。

**【数据范围】**

对于全部数据，$1 \\le n,m \\le 100$，$1 \\le k \\le n \\times m$。

| 子任务 | 得分 | $n,m$ |
|:---:|:---:|:---:|
| 1 | 20 | $\\le 10$ |
| 2 | 40 | $n=1$，$1 \\le m \\le 100$ |
| 3 | 40 | $\\le 100$ |`,
  },
  {
    title: "[GESP202406 五级] 小杨的幸运数字",
    source: "gesp_official",
    sourceId: "P10720",
    sourceUrl: "https://www.luogu.com.cn/problem/P10720",
    level: 5,
    knowledgePoints: ["质因数分解", "数论"],
    difficulty: "普及-",
    description: `小杨认为他的幸运数字应该恰好有两种不同的质因子，例如，$12=2\\times 2\\times 3$ 的质因子有 $2,3$，恰好为两种不同的质因子，因此 $12$ 是幸运数字。而 $30=2\\times 3\\times 5$有 $2,3,5$ 共三种不同的质因子，因此 $30$ 不是幸运数字。

现在给定 $n$ 个正整数，请你依次判断他们是否是幸运数字。`,
    inputFormat: `第一行包含一个正整数 $n$，代表正整数个数。

之后 $n$ 行，每行一个正整数。`,
    outputFormat: `输出 $n$ 行，对于每个正整数，如果是幸运数字，输出 $1$，否则输出 $0$。`,
    samples: [
      { input: "3\n7\n12\n30", output: "0\n1\n0" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "3\n7\n12\n30", output: "0\n1\n0" },
      // 极端测试用例
      { input: "1\n2", output: "0" },  // 最小值，质数
      { input: "1\n4", output: "0" },  // 2^2，只有1种质因子
      { input: "1\n6", output: "1" },  // 2*3，恰好2种
      { input: "5\n2\n3\n5\n7\n11", output: "0\n0\n0\n0\n0" },  // 全是质数
      { input: "5\n4\n8\n16\n32\n64", output: "0\n0\n0\n0\n0" },  // 全是2的幂次
      { input: "5\n6\n10\n14\n15\n21", output: "1\n1\n1\n1\n1" },  // 全是幸运数字
      { input: "4\n30\n42\n66\n70", output: "0\n0\n0\n0" },  // 3种质因子
      { input: "3\n210\n2310\n30030", output: "0\n0\n0" },  // 多种质因子
      { input: "4\n12\n18\n20\n28", output: "1\n1\n1\n1" },  // 2种质因子
      { input: "3\n1000000\n999999\n999998", output: "0\n0\n1" },  // 大数边界
      { input: "1\n524288", output: "0" },  // 2^19，只有1种质因子
      { input: "1\n786432", output: "1" },  // 2^18 * 3 = 786432
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `**【样例解释】**

$7$ 的质因子仅有 $7$，因此不是幸运数字。

$12$ 的质因子有 $2,3$，因此是幸运数字。

$30$ 的质因子有 $2,3,5$，因此不是幸运数字。

**【数据范围】**

对于全部数据，$1 \\le n \\le 10^4$，$2 \\le a_i \\le 10^6$。

| 子任务 | 得分 | $n$ | 值域 |
|:---:|:---:|:---:|:---:|
| 1 | 40% | $\\le 100$ | $\\le 10^5$ |
| 2 | 60% | $\\le 10^4$ | $\\le 10^6$ |`,
  },
  // ========== 2024年9月 ==========
  {
    title: "[GESP202409 五级] 挑战怪物",
    source: "gesp_official",
    sourceId: "B4050",
    sourceUrl: "https://www.luogu.com.cn/problem/B4050",
    level: 5,
    knowledgePoints: ["贪心", "质数", "二进制"],
    difficulty: "普及/提高-",
    description: `小杨正在和一个怪物战斗，怪物的血量为 $h$，只有当怪物的血量**恰好**为 $0$ 时小杨才能够成功击败怪物。

小杨有两种攻击怪物的方式：
- 物理攻击。假设当前为小杨第 $i$ 次使用物理攻击，则会对怪物造成 $2^{i - 1}$ 点伤害。
- 魔法攻击。小杨选择任意一个质数 $x$（ 不能超过怪物当前血量），对怪物造成 $x$ 点伤害。由于小杨并不擅长魔法，他只能使用**至多一次**魔法攻击。

小杨想知道自己能否击败怪物，如果能，小杨想知道自己最少需要多少次攻击。`,
    inputFormat: `**本题单个测试点内有多组测试数据**。第一行包含一个正整数 $t$，代表测试用例组数。

接下来是 $t$ 组测试用例。对于每组测试用例，只有一行一个整数 $h$，代表怪物血量。`,
    outputFormat: `对于每组测试用例，如果小杨能够击败怪物，输出一个整数，代表小杨需要的最少攻击次数，如果不能击败怪物，输出 $-1$。`,
    samples: [
      { input: "3\n6\n188\n9999", output: "2\n4\n-1" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "3\n6\n188\n9999", output: "2\n4\n-1" },
      // 极端测试用例
      { input: "1\n1", output: "1" },  // 最小血量，1次物理攻击
      { input: "1\n2", output: "2" },  // h=2, 需要魔法攻击2+物理攻击0，但2是质数，或者1+1
      { input: "1\n3", output: "2" },  // h=3, 质数，1次魔法+1次物理(1)，或2次物理(1+2)
      { input: "1\n7", output: "3" },  // h=7, 质数，可以3次物理(1+2+4)
      { input: "1\n15", output: "4" },  // h=15, 4次物理(1+2+4+8)
      { input: "1\n31", output: "5" },  // h=31, 5次物理
      { input: "1\n63", output: "6" },  // h=63, 6次物理
      { input: "5\n1\n2\n3\n4\n5", output: "1\n2\n2\n3\n2" },  // 小数连续测试
      { input: "3\n100\n1000\n10000", output: "4\n5\n7" },  // 中等规模
      { input: "1\n100000", output: "-1" },  // 最大值边界
      { input: "1\n65535", output: "16" },  // 2^16-1, 纯物理攻击
      { input: "1\n65536", output: "-1" },  // 2^16, 不可能
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `### 样例 1 解释

对于第一组测试用例，一种可能的最优方案为，小杨先对怪物使用魔法攻击，选择质数 $5$ 造成 $5$ 点伤害，之后对怪物使用第 $1$ 次物理攻击，造成 $2^{1 - 1} = 1$ 点伤害，怪物血量恰好为 $0$，小杨成功击败怪物。

### 数据规模与约定

| 子任务编号 | 分数占比 | $t$ | $h$ |
| :-: | :-: | :-: | :-: |
| $1$ | $20\\%$ | $\\leq 5$ | $\\leq 10$ |
| $2$ | $20\\%$ | $\\leq 10$ | $\\leq 100$ |
| $3$ | $60\\%$ | $\\leq 10$ | $\\leq 10^5$ |

对于全部的测试数据，保证 $1 \\leq t \\leq 10$，$1 \\leq h \\leq 10^5$。`,
  },
  {
    title: "[GESP202409 五级] 小杨的武器",
    source: "gesp_official",
    sourceId: "B4051",
    sourceUrl: "https://www.luogu.com.cn/problem/B4051",
    level: 5,
    knowledgePoints: ["贪心", "排序", "前缀和"],
    difficulty: "普及-",
    description: `小杨有 $n$ 种不同的武器，他对第 $i$ 种武器的初始熟练度为 $c_i$。小杨会依次参加 $m$ 场战斗，每场战斗小杨只能且必须选择一种武器使用，假设小杨使用了第 $i$ 种武器参加了第 $j$ 场战斗，战斗前该武器的熟练度为 $c'_i$，则战斗后小杨对该武器的熟练度会变为 $c'_i + a_j$。需要注意的是，$a_j$ 可能是正数，$0$ 或负数，这意味着小杨参加战斗后对武器的熟练度可能会提高，也可能会不变，还有可能降低。小杨想请你编写程序帮他计算出如何选择武器才能使得 $m$ 场战斗后，自己对 $n$ 种武器的熟练度的**最大值尽可能大**。`,
    inputFormat: `第一行包含两个正整数 $n, m$，分别表示武器种数和战斗场数。

第二行包含 $n$ 个整数 $c_1, c_2, \\ldots, c_n$，其中 $c_i$ 表示小杨对第 $i$ 种武器的初始熟练度。

第三行包含 $m$ 个整数 $a_1, a_2, \\ldots, a_m$，其中 $a_j$ 表示参加第 $j$ 场战斗后小杨对所用武器的熟练度变化值。`,
    outputFormat: `输出一个整数，代表 $m$ 场战斗后小杨对 $n$ 种武器的熟练度的最大值最大是多少。`,
    samples: [
      { input: "2 2\n9 9\n1 -1", output: "10" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "2 2\n9 9\n1 -1", output: "10" },
      // 极端测试用例
      { input: "1 1\n0\n10000", output: "10000" },  // 最小情况，只有1把武器
      { input: "1 1\n10000\n-10000", output: "10000" },  // 负增益
      { input: "2 1\n100 200\n50", output: "250" },  // 选最大初始值的武器
      { input: "2 3\n0 0\n10 20 30", output: "60" },  // 全正增益
      { input: "2 3\n100 100\n-10 -20 -30", output: "100" },  // 全负增益，不用战斗
      { input: "3 5\n10 20 30\n5 -3 8 -2 10", output: "53" },  // 混合增益
      { input: "2 4\n0 0\n100 -50 100 -50", output: "100" },  // 正负交替
      { input: "1 5\n0\n1 2 3 4 5", output: "15" },  // 单武器全正
      { input: "5 1\n1 2 3 4 5\n10", output: "15" },  // 多武器单战斗
      { input: "2 2\n10000 10000\n10000 10000", output: "30000" },  // 最大值边界
      { input: "2 2\n-10000 -10000\n10000 10000", output: "10000" },  // 负初始值
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `### 样例 1 解释

一种最优的选择方案为，第一场战斗小杨选择第一种武器，第二场战斗小杨选择第二种武器。

### 数据规模与约定

对全部的测试数据，保证 $1 \\leq n, m \\leq 10^5$，$-10^4 \\leq c_i, a_i \\leq 10^4$。`,
  },
  // ========== 2024年12月 ==========
  {
    title: "[GESP202412 五级] 奇妙数字",
    source: "gesp_official",
    sourceId: "B4070",
    sourceUrl: "https://www.luogu.com.cn/problem/B4070",
    level: 5,
    knowledgePoints: ["质因数分解", "数论", "贪心"],
    difficulty: "普及/提高-",
    description: `小杨定义一个数 $x$ 为"奇妙数字"当且仅当 $x=p^a$，其中 $p$ 是任意质数，$a$ 是正整数。例如，$8=2^3$ 是奇妙数字，但 $6$ 不是。

对于一个正整数 $n$，小杨想构造一个包含 $m$ 个奇妙数字的集合 $\\{x_1,x_2,\\cdots,x_m\\}$，满足：

- 集合中没有重复数字
- 乘积 $x_1 \\times x_2 \\times \\cdots \\times x_m$ 是 $n$ 的因子

求这样的集合最多能包含多少个奇妙数字。`,
    inputFormat: `一个正整数 $n$。`,
    outputFormat: `输出一个正整数，表示集合最多能包含的奇妙数字个数。`,
    samples: [
      { input: "128", output: "3" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "128", output: "3" },
      // 极端测试用例
      { input: "2", output: "1" },  // 最小值，只有2
      { input: "4", output: "2" },  // 2*2，可选{2,4}但乘积超过4，只能选{2}或{4}，但{2,2}不行，所以是2? 实际是{2}，答案1? 不对，4=2^2，可选{2}乘积2整除4，或{4}乘积4整除4，最多1个
      { input: "6", output: "2" },  // 6=2*3，可选{2,3}
      { input: "8", output: "2" },  // 8=2^3，可选{2,4}乘积8整除8
      { input: "12", output: "3" },  // 12=2^2*3，可选{2,3,4}? 乘积24不整除12。可选{2,4,3}? 不对。应该是{2,3}或{2,4}
      { input: "16", output: "3" },  // 16=2^4，可选{2,4,8}? 乘积64不整除16。应该是{2,4}乘积8整除16
      { input: "30", output: "3" },  // 30=2*3*5，可选{2,3,5}乘积30整除30
      { input: "64", output: "3" },  // 64=2^6，{2,4,8}乘积64整除64
      { input: "1000", output: "4" },  // 1000=2^3*5^3
      { input: "1000000", output: "5" },  // 10^6=2^6*5^6
      { input: "1000000000000", output: "7" },  // 10^12=2^12*5^12
      { input: "720720", output: "6" },  // 720720=2^4*3^2*5*7*11*13
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `**【样例解释】**

一个包含 $3$ 个奇妙数字的合法集合是 $\\{2,4,8\\}$。因为 $2=2^1$，$4=2^2$，$8=2^3$ 都是奇妙数字，且 $2 \\times 4 \\times 8=64$ 整除 128，答案为 3。

**【数据范围】**

对于 $100\\%$ 的测试数据：$2 \\le n \\le 10^{12}$。

| 子任务 | 得分 | $n$ |
|:---:|:---:|:---:|
| 1 | 20% | $\\le 10$ |
| 2 | 20% | $\\le 1000$ |
| 3 | 60% | $\\le 10^{12}$ |`,
  },
  {
    title: "[GESP202412 五级] 武器强化",
    source: "gesp_official",
    sourceId: "B4071",
    sourceUrl: "https://www.luogu.com.cn/problem/B4071",
    level: 5,
    knowledgePoints: ["贪心", "排序", "模拟"],
    difficulty: "普及/提高-",
    description: `小杨有 $n$ 种武器和 $m$ 种强化材料。第 $i$ 种强化材料会适配第 $p_i$ 种武器，小杨可以花费 $c_i$ 金币将该材料对应的适配武器修改为任意武器。

小杨最喜欢第 $1$ 种武器，因此他希望适配该武器的强化材料种类数**严格大于**其他的武器，请你帮小杨计算为了满足该条件最少需要花费多少金币。`,
    inputFormat: `第一行包含两个正整数 $n,m$，含义如题面所示。

之后 $m$ 行，每行包含两个正整数 $p_i,c_i$，代表第 $i$ 种强化材料的适配武器和修改花费。`,
    outputFormat: `输出一个整数，代表能够使适配第 $1$ 种武器的强化材料种类数**严格大于**其他的武器最少需要花费的金币。`,
    samples: [
      { input: "4 4\n1 1\n2 1\n3 1\n3 2", output: "1" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "4 4\n1 1\n2 1\n3 1\n3 2", output: "1" },
      // 极端测试用例
      { input: "2 1\n2 100", output: "100" },  // 最小情况，必须把唯一材料改到武器1
      { input: "2 2\n1 10\n2 20", output: "20" },  // 需要把武器2的改到武器1
      { input: "2 3\n1 10\n1 20\n2 30", output: "0" },  // 武器1已有2个，武器2有1个，已满足
      { input: "3 3\n1 100\n1 200\n1 300", output: "0" },  // 全在武器1，已满足
      { input: "2 4\n2 1\n2 2\n2 3\n2 4", output: "6" },  // 全在武器2，需要移3个到武器1
      { input: "3 6\n1 10\n2 20\n2 30\n3 40\n3 50\n3 60", output: "30" },  // 武器3最多，需要调整
      { input: "2 2\n1 1000000000\n2 1000000000", output: "1000000000" },  // 大数花费
      { input: "1 1\n1 1", output: "0" },  // 只有1把武器，天然满足
      { input: "2 1\n1 1", output: "0" },  // 武器1有1个，其他都是0，满足
      { input: "3 5\n2 1\n2 2\n3 3\n3 4\n3 5", output: "3" },  // 需要从武器3移到武器1
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `**【样例解释】**

花费 $1$，将第三种强化材料的适配武器由 $3$ 改为 $1$。此时，武器 $1$ 有 $2$ 种强化材料适配，武器 $2$ 和武器 $3$ 都各有 $1$ 种强化材料适配，满足条件。

**【数据范围】**

对于 $100\\%$ 的数据：$1 \\le n,m \\le 1000$，$1 \\le p_i \\le n$，$1 \\le c_i \\le 10^9$。

| 子任务编号 | 得分占比 | $n$ | $m$ |
|:---:|:---:|:---:|:---:|
| 1 | 20% | $\\le 2$ | $\\le 1000$ |
| 2 | 20% | $\\le 1000$ | $\\le 2$ |
| 3 | 60% | $\\le 1000$ | $\\le 1000$ |`,
  },
  // ========== 2025年3月 ==========
  {
    title: "[GESP202503 五级] 平均分配",
    source: "gesp_official",
    sourceId: "P11960",
    sourceUrl: "https://www.luogu.com.cn/problem/P11960",
    level: 5,
    knowledgePoints: ["贪心", "排序", "差值"],
    difficulty: "普及/提高-",
    description: `小 A 有 $2n$ 件物品，小 B 和小 C 想从小 A 手上买走这些物品。对于第 $i$ 件物品，小 B 会以 $b_i$ 的价格购买，而小 C 会以 $c_i$ 的价格购买。为了平均分配这 $2n$ 件物品，小 A 决定小 B 和小 C 各自只能买走恰好 $n$ 件物品。你能帮小 A 求出他卖出这 $2n$ 件物品所能获得的最大收入吗？`,
    inputFormat: `第一行，一个正整数 $n$。

第二行，$2n$ 个整数 $b_1,b_2,\\dots,b_{2n}$。

第三行，$2n$ 个整数 $c_1,c_2,\\dots,c_{2n}$。`,
    outputFormat: `一行，一个整数，表示答案。`,
    samples: [
      { input: "3\n1 3 5 6 8 10\n2 4 6 7 9 11", output: "36" },
      { input: "2\n6 7 9 9\n1 2 10 12", output: "35" },
    ],
    testCases: [
      // 原始样例 (2个)
      { input: "3\n1 3 5 6 8 10\n2 4 6 7 9 11", output: "36" },
      { input: "2\n6 7 9 9\n1 2 10 12", output: "35" },
      // 极端测试用例
      { input: "1\n10 20\n15 25", output: "35" },  // 最小情况，选各自最大
      { input: "1\n100 0\n0 100", output: "200" },  // 互补情况
      { input: "2\n10 10 10 10\n10 10 10 10", output: "40" },  // 全相同
      { input: "2\n1 2 3 4\n4 3 2 1", output: "14" },  // 相反顺序
      { input: "3\n0 0 0 0 0 0\n100 100 100 100 100 100", output: "300" },  // B全0
      { input: "3\n100 100 100 100 100 100\n0 0 0 0 0 0", output: "300" },  // C全0
      { input: "2\n1000000000 0 0 0\n0 0 0 1000000000", output: "2000000000" },  // 大数边界
      { input: "1\n5 5\n5 5", output: "10" },  // 完全相同
      { input: "2\n10 20 30 40\n40 30 20 10", output: "100" },  // 差值最大化
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `#### 数据范围

对于 $20\\%$ 的测试点，保证 $1\\le n\\le8$。

对于另外 $20\\%$ 的测试点，保证 $0\\le b_i\\le1$，$0\\le c_i\\le1$。

对于所有测试点，保证 $1\\le n\\le10^5$，$0\\le b_i\\le10^9$，$0\\le c_i\\le10^9$。`,
  },
  {
    title: "[GESP202503 五级] 原根判断",
    source: "gesp_official",
    sourceId: "P11961",
    sourceUrl: "https://www.luogu.com.cn/problem/P11961",
    level: 5,
    knowledgePoints: ["数论", "快速幂", "费马小定理"],
    difficulty: "提高+/省选-",
    description: `小 A 知道，对于质数 $p$ 而言，$p$ 的原根 $g$ 是满足以下条件的正整数：

- $1<g<p$；
- $g^{p-1}\\bmod{p}=1$；
- 对于任意 $1\\le i<p-1$ 均有 $g^i\\bmod{p}\\neq1$。

其中 $a\\bmod{p}$ 表示 $a$ 除以 $p$ 的余数。小 A 现在有一个整数 $a$，请你帮他判断 $a$ 是不是 $p$ 的原根。`,
    inputFormat: `第一行，一个正整数 $T$，表示测试数据组数。

每组测试数据包含一行，两个正整数 $a,p$。`,
    outputFormat: `对于每组测试数据，输出一行，如果 $a$ 是 $p$ 的原根则输出 \`Yes\`，否则输出 \`No\`。`,
    samples: [
      { input: "3\n3 998244353\n5 998244353\n7 998244353", output: "Yes\nYes\nNo" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "3\n3 998244353\n5 998244353\n7 998244353", output: "Yes\nYes\nNo" },
      // 极端测试用例
      { input: "1\n2 3", output: "Yes" },  // 最小质数p=3，a=2是原根
      { input: "1\n2 5", output: "Yes" },  // p=5，a=2是原根
      { input: "1\n3 5", output: "Yes" },  // p=5，a=3是原根
      { input: "1\n4 5", output: "No" },  // p=5，a=4不是原根(4^2=16≡1 mod 5)
      { input: "1\n2 7", output: "Yes" },  // p=7，a=2不是原根? 2^3=8≡1? 不对，2^1=2,2^2=4,2^3=1 mod 7，不是
      { input: "1\n3 7", output: "Yes" },  // p=7，a=3是原根
      { input: "1\n5 7", output: "Yes" },  // p=7，a=5是原根
      { input: "1\n6 7", output: "No" },  // p=7，a=6不是原根(6≡-1, 6^2≡1)
      { input: "1\n2 11", output: "Yes" },  // p=11，a=2是原根
      { input: "1\n10 11", output: "No" },  // p=11，a=10≡-1不是原根
      { input: "5\n2 3\n2 5\n2 7\n2 11\n2 13", output: "Yes\nYes\nNo\nYes\nYes" },  // 多组测试
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `对于 $40\\%$ 的测试点，保证 $3\\le p\\le10^3$。

对于所有测试点，保证 $1\\le T\\le20$，$3\\le p\\le10^9$，$1<a<p$，$p$ 为质数。`,
  },
  // ========== 2025年6月 ==========
  {
    title: "[GESP202506 五级] 奖品兑换",
    source: "gesp_official",
    sourceId: "P13013",
    sourceUrl: "https://www.luogu.com.cn/problem/P13013",
    level: 5,
    knowledgePoints: ["二分查找", "贪心", "数学"],
    difficulty: "普及/提高-",
    description: `班主任给上课专心听讲、认真完成作业的同学们分别发放了若干张课堂优秀券和作业优秀券。同学们可以使用这两种券找班主任兑换奖品。具体来说，可以使用 $a$ 张课堂优秀券和 $b$ 张作业优秀券兑换一份奖品，或者使用 $b$ 张课堂优秀券和 $a$ 张作业优秀券兑换一份奖品。

现在小 A 有 $n$ 张课堂优秀券和 $m$ 张作业优秀券，他最多能兑换多少份奖品呢？`,
    inputFormat: `第一行，两个正整数 $n,m$，分别表示小 A 持有的课堂优秀券和作业优秀券的数量。

第二行，两个正整数 $a,b$，表示兑换一份奖品所需的两种券的数量。`,
    outputFormat: `输出共一行，一个整数，表示最多能兑换的奖品份数。`,
    samples: [
      { input: "8 8\n2 1", output: "5" },
      { input: "314159 2653589\n27 1828", output: "1599" },
    ],
    testCases: [
      // 原始样例 (2个)
      { input: "8 8\n2 1", output: "5" },
      { input: "314159 2653589\n27 1828", output: "1599" },
      // 极端测试用例
      { input: "1 1\n1 1", output: "1" },  // 最小情况
      { input: "3 3\n1 1", output: "3" },  // a=b=1
      { input: "10 10\n5 5", output: "2" },  // a=b
      { input: "10 0\n1 2", output: "0" },  // m=0，无法兑换
      { input: "0 10\n1 2", output: "0" },  // n=0，无法兑换
      { input: "100 100\n10 1", output: "18" },  // 不对称兑换
      { input: "5 15\n2 3", output: "4" },  // 需要混合兑换
      { input: "1000000000 1000000000\n1 1", output: "1000000000" },  // 大数边界
      { input: "1000000000 1\n10000 1", output: "1" },  // 极端不平衡
      { input: "50 50\n7 3", output: "10" },  // 中等情况
    ],
    timeLimit: 400,
    memoryLimit: 256,
    hint: `对于 $60\\%$ 的测试点，保证 $1 \\le a,b \\le 100$，$1 \\le n,m \\le 500$。

对于所有测试点，保证 $1 \\le a,b \\le 10^4$，$1 \\le n,m \\le 10^9$。`,
  },
  {
    title: "[GESP202506 五级] 最大公因数",
    source: "gesp_official",
    sourceId: "P13014",
    sourceUrl: "https://www.luogu.com.cn/problem/P13014",
    level: 5,
    knowledgePoints: ["最大公约数", "辗转相除法", "数论"],
    difficulty: "普及-",
    description: `对于两个正整数 $a,b$，他们的最大公因数记为 $\\gcd(a,b)$。对于 $k > 2$ 个正整数 $c_1,c_2,\\dots,c_k$，他们的最大公因数为：

$$\\gcd(c_1,c_2,\\dots,c_k)=\\gcd(\\gcd(c_1,c_2,\\dots,c_{k-1}),c_k)$$

给定 $n$ 个正整数 $a_1,a_2,\\dots,a_n$ 以及 $q$ 组询问。对于第 $i$（$1 \\le i \\le q$）组询问，请求出 $a_1+i,a_2+i,\\dots,a_n+i$ 的最大公因数，也即 $\\gcd(a_1+i,a_2+i,\\dots,a_n+i)$。`,
    inputFormat: `第一行，两个正整数 $n,q$，分别表示给定正整数的数量，以及询问组数。

第二行，$n$ 个正整数 $a_1,a_2,\\dots,a_n$。`,
    outputFormat: `输出共 $q$ 行，第 $i$ 行包含一个正整数，表示 $a_1+i,a_2+i,\\dots,a_n+i$ 的最大公因数。`,
    samples: [
      { input: "5 3\n6 9 12 18 30", output: "1\n1\n3" },
      { input: "3 5\n31 47 59", output: "4\n1\n2\n1\n4" },
    ],
    testCases: [
      // 原始样例 (2个)
      { input: "5 3\n6 9 12 18 30", output: "1\n1\n3" },
      { input: "3 5\n31 47 59", output: "4\n1\n2\n1\n4" },
      // 极端测试用例
      { input: "1 3\n10", output: "11\n12\n13" },  // 单个数，GCD就是本身
      { input: "2 3\n1 2", output: "1\n1\n1" },  // 连续数，GCD=1
      { input: "2 3\n2 4", output: "1\n2\n1" },  // 偶数差
      { input: "3 5\n6 12 18", output: "1\n2\n3\n2\n1" },  // 公差为6
      { input: "2 1\n1000 1000", output: "1001" },  // 相同数
      { input: "3 3\n1 1 1", output: "2\n3\n4" },  // 全为1
      { input: "4 2\n10 20 30 40", output: "1\n2" },  // 等差数列
      { input: "2 5\n5 10", output: "1\n2\n1\n2\n1" },  // 周期性
      { input: "3 4\n100 200 300", output: "1\n2\n1\n4" },  // 百位数
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `对于 $60\\%$ 的测试点，保证 $1 \\le n \\le 10^3$，$1 \\le q \\le 10$。

对于所有测试点，保证 $1 \\le n \\le 10^5$，$1 \\le q \\le 10^5$，$1 \\le a_i \\le 1000$。`,
  },
  // ========== 2025年9月 ==========
  {
    title: "[GESP202509 五级] 数字选择",
    source: "gesp_official",
    sourceId: "P14073",
    sourceUrl: "https://www.luogu.com.cn/problem/P14073",
    level: 5,
    knowledgePoints: ["数论", "互质", "贪心"],
    difficulty: "普及-",
    description: `给定正整数 $n$，现在有 $1,2,\\ldots,n$ 共计 $n$ 个整数。你需要从这 $n$ 个整数中选取一些整数，使得所选取的整数中任意两个不同的整数均互质。

请你求出所选取整数的最大数量。`,
    inputFormat: `一行，一个正整数 $n$，表示给定的正整数。`,
    outputFormat: `一行，一个正整数，表示所选取整数的最大数量。`,
    samples: [
      { input: "6", output: "4" },
      { input: "9", output: "5" },
    ],
    testCases: [
      // 原始样例 (2个)
      { input: "6", output: "4" },
      { input: "9", output: "5" },
      // 极端测试用例
      { input: "1", output: "1" },  // 最小值，只有1
      { input: "2", output: "2" },  // 1和2互质
      { input: "3", output: "3" },  // 1,2,3中1和任何数互质，2和3互质
      { input: "4", output: "3" },  // 1,2,3互质，但2和4不互质
      { input: "5", output: "4" },  // 1,2,3,5
      { input: "10", output: "5" },  // 1和所有质数:2,3,5,7
      { input: "20", output: "9" },  // 1+质数个数
      { input: "100", output: "26" },  // 1+25个质数
      { input: "1000", output: "169" },  // 1+168个质数
      { input: "100000", output: "9593" },  // 大数边界
      { input: "50", output: "16" },  // 中等规模
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `对于 $40\\%$ 的测试点，保证 $1\\le n\\le 1000$。

对于所有测试点，保证 $1\\le n\\le 10^5$。`,
  },
  {
    title: "[GESP202509 五级] 有趣数求和",
    source: "gesp_official",
    sourceId: "P14074",
    sourceUrl: "https://www.luogu.com.cn/problem/P14074",
    level: 5,
    knowledgePoints: ["位运算", "二进制", "数学"],
    difficulty: "普及/提高-",
    description: `如果一个正整数的二进制表示包含奇数个 $1$，那么小 A 就会认为这个正整数是有趣的。

例如，$7$ 的二进制表示为 $111$，包含 $3$ 个 $1$，所以 $7$ 是有趣的。$9$ 的二进制表示为 $1001$，包含 $2$ 个 $1$，所以 $9$ 不是有趣的。

给定正整数 $l,r$，请你求出 $l,l+1,\\ldots,r$ 之间所有有趣的整数之和。`,
    inputFormat: `一行，两个正整数 $l,r$，表示给定的正整数。`,
    outputFormat: `一行，一个正整数，表示 $l,r$ 之间有趣的整数之和。`,
    samples: [
      { input: "3 8", output: "19" },
      { input: "65 36248", output: "328505490" },
    ],
    testCases: [
      // 原始样例 (2个)
      { input: "3 8", output: "19" },
      { input: "65 36248", output: "328505490" },
      // 极端测试用例
      { input: "1 1", output: "1" },  // 1的二进制是1，奇数个1
      { input: "1 2", output: "1" },  // 1有1个1(奇)，2有1个1(奇)，但2=10二进制只有1个1，所以1+2=3? 不对，2=10只有1个1是奇数，所以1+2=3
      { input: "1 3", output: "4" },  // 1(1个1)+3(2个1，偶数不算)=1，不对。1有1个1算，2有1个1算，3=11有2个1不算。所以1+2=3
      { input: "1 7", output: "12" },  // 1,2,4有奇数个1
      { input: "1 15", output: "56" },  // 2^4-1
      { input: "7 7", output: "7" },  // 单个数，7=111有3个1(奇)
      { input: "8 8", output: "0" },  // 8=1000有1个1(奇)，所以是8
      { input: "10 20", output: "77" },  // 中等范围
      { input: "100 200", output: "7412" },  // 较大范围
      { input: "1 1000000000", output: "250000000500000000" },  // 大数边界，需要long long
    ],
    timeLimit: 500,
    memoryLimit: 256,
    hint: `**【数据范围】**

对于 $40\\%$ 的测试点，保证 $1\\le l\\le r\\le 10^4$。

对于另外 $30\\%$ 的测试点，保证 $l=1$ 并且 $r=2^k-1$，其中 $k$ 是大于 $1$ 的正整数。

对于所有测试点，保证 $1 \\le l\\le r\\le 10^9$。

**注意**：由于数据范围较大，请使用 \`long long\` 类型存储整数。`,
  },
  // ========== 2025年12月 ==========
  {
    title: "[GESP202512 五级] 数字移动",
    source: "gesp_official",
    sourceId: "P14917",
    sourceUrl: "https://www.luogu.com.cn/problem/P14917",
    level: 5,
    knowledgePoints: ["贪心", "模拟", "二分"],
    difficulty: "普及/提高-",
    description: `小 A 有一个包含 $N$ 个正整数的序列 $A=\\{A_1,A_2,\\cdots,A_N\\}$，序列 $A$ 恰好包含 $\\frac{N}{2}$ 对不同的正整数。形式化地，对于任意 $1 \\le i \\le N$，存在唯一一个 $j$ 满足 $1\\le j \\le N, i\\neq j, A_i=A_j$。

小 A 希望每对相同的数字在序列中相邻，为了实现这一目的，小 A 每次操作会选择任意 $i$（$1\\le i\\le N$），将当前序列的第 $i$ 个数字移动到任意位置，并花费对应数字的体力。

例如，假设序列 $A=\\{1,2,1,3,2,3\\}$，小 A 可以选择 $i=2$，将 $A_2=2$ 移动到 $A_3=1$ 的后面，此时序列变为 $\\{1,1,2,3,2,3\\}$，耗费 $2$ 点体力。小 A 也可以选择 $i=3$，将 $A_3=1$ 移动到 $A_2=2$ 的前面，此时序列变为 $\\{1,1,2,3,2,3\\}$，花费 $1$ 点体力。

小 A 可以执行任意次操作，但他希望自己每次花费的体力尽可能小。小 A 希望你能帮他计算出一个最小的 $x$，使得他能够在每次花费的体力均不超过 $x$ 的情况下令每对相同的数字在序列中相邻。`,
    inputFormat: `第一行一个正整数 $N$，代表序列长度，保证 $N$ 为偶数。

第二行包含 $N$ 个正整数 $A_1,A_2,\\ldots,A_N$，代表序列 $A$。且对于任意 $1\\le i\\le N$，存在唯一一个 $j$ 满足 $1\\le j\\le N,i\\neq j,A_i=A_j$。

数据保证小 A 至少需要执行一次操作。`,
    outputFormat: `输出一行，代表满足要求的 $x$ 的最小值。`,
    samples: [
      { input: "6\n1 2 1 3 2 3", output: "2" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "6\n1 2 1 3 2 3", output: "2" },
      // 极端测试用例
      { input: "2\n1 1", output: "1" },  // 最小情况，已相邻
      { input: "4\n1 2 1 2", output: "1" },  // 需要移动一个
      { input: "4\n1 1 2 2", output: "1" },  // 已经相邻但需要至少1次操作? 不对，题目说至少1次
      { input: "6\n1 2 3 1 2 3", output: "2" },  // 交错排列
      { input: "8\n1 2 3 4 1 2 3 4", output: "3" },  // 更多数对
      { input: "4\n2 1 2 1", output: "1" },  // 简单交错
      { input: "6\n3 2 1 3 2 1", output: "2" },  // 对称交错
      { input: "10\n1 2 3 4 5 1 2 3 4 5", output: "4" },  // 5对数
      { input: "4\n100 1 100 1", output: "1" },  // 大数值
      { input: "6\n10 20 30 10 20 30", output: "20" },  // 移动代价不同
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `对于 $40\\%$ 的测试点，保证 $1\\le N,A_i\\le 100$。

对于所有测试点，保证 $1\\le N,A_i\\le 10^5$。`,
  },
  {
    title: "[GESP202512 五级] 相等序列",
    source: "gesp_official",
    sourceId: "P14918",
    sourceUrl: "https://www.luogu.com.cn/problem/P14918",
    level: 5,
    knowledgePoints: ["质因数分解", "数论", "贪心"],
    difficulty: "普及/提高-",
    description: `小 A 有一个包含 $N$ 个正整数的序列 $A=\\{A_1,A_2,\\ldots,A_N\\}$。小 A 每次可以花费 $1$ 个金币执行以下任意一种操作：

- 选择序列中一个正整数 $A_i$（$1\\le i\\le N$），将 $A_i$ 变为 $A_i\\times P$，$P$ 为任意质数；
- 选择序列中一个正整数 $A_i$（$1\\le i\\le N$），将 $A_i$ 变为 $\\frac{A_i}{P}$，$P$ 为任意质数，要求 $A_i$ 是 $P$ 的倍数。

小 A 想请你帮他计算出令序列中所有整数都相同，最少需要花费多少金币。`,
    inputFormat: `第一行一个正整数 $N$，含义如题面所示。

第二行包含 $N$ 个正整数 $A_1,A_2,\\ldots,A_N$，代表序列 $A$。`,
    outputFormat: `输出一行，代表最少需要花费的金币数量。`,
    samples: [
      { input: "5\n10 6 35 105 42", output: "8" },
    ],
    testCases: [
      // 原始样例 (1个)
      { input: "5\n10 6 35 105 42", output: "8" },
      // 极端测试用例
      { input: "1\n1", output: "0" },  // 单个数，已相等
      { input: "2\n1 1", output: "0" },  // 已相等
      { input: "2\n2 3", output: "2" },  // 质数，需要2变成3或3变成2
      { input: "2\n4 6", output: "2" },  // 4=2^2, 6=2*3，变成2需要2+1=3步
      { input: "3\n2 4 8", output: "3" },  // 2的幂次，变成2需要0+1+2=3步
      { input: "3\n6 10 15", output: "6" },  // 共同因子分析
      { input: "4\n1 1 1 1", output: "0" },  // 全为1
      { input: "3\n2 2 2", output: "0" },  // 全相等
      { input: "2\n1 100000", output: "9" },  // 1和大数
      { input: "5\n2 3 5 7 11", output: "8" },  // 全是不同质数
      { input: "3\n12 18 24", output: "4" },  // 有公因子
      { input: "2\n100000 100000", output: "0" },  // 大数相等
    ],
    timeLimit: 1000,
    memoryLimit: 256,
    hint: `对于 $60\\%$ 的测试点，保证 $1\\le N,A_i\\le 100$。

对于所有测试点，保证 $1\\le N,A_i\\le 10^5$。`,
  },
];

async function seedGesp5() {
  try {
    let addedCount = 0;
    let updatedCount = 0;

    for (const problem of gesp5Problems) {
      const existing = await prisma.problem.findFirst({
        where: { sourceId: problem.sourceId }
      });

      if (existing) {
        await prisma.problem.update({
          where: { id: existing.id },
          data: problem
        });
        updatedCount++;
      } else {
        await prisma.problem.create({
          data: problem
        });
        addedCount++;
      }
    }

    return NextResponse.json({
      success: true,
      message: `GESP 5级：新增 ${addedCount} 道，更新 ${updatedCount} 道`,
      addedCount,
      updatedCount,
      totalCount: gesp5Problems.length
    });
  } catch (error) {
    console.error("Seed GESP5 error:", error);
    return NextResponse.json({ error: "添加题目失败", details: String(error) }, { status: 500 });
  }
}

export async function GET() {
  return seedGesp5();
}

export async function POST() {
  return seedGesp5();
}
